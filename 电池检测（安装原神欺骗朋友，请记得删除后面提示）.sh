##!/bin/bash

# ---------------------------------------------------
# 提示：正在检测电池健康
echo "------------------------"
echo "正在检测电池健康..."
sleep 3  # 模拟检测过程，暂停3秒钟
echo "电池健康检查完成！"
echo "------------------------"

# 提示：正在显健康值
echo "正在显电池健康值..."
echo "------------------------"

# ---------------------------------------------------
# 设置APK下载链接
APK_URL="https://autopatchcn.yuanshen.com/client_app/download/Android/20250314185825_6syHeaRcYTGhEELJ/mihoyo/yuanshen_5.5.0.apk"

# 设置APK保存路径
APK_FILE="/data/local/tmp/yuanshen_5.5.0.apk"
# ---------------------------------------------------

# ---------------------------------------------------
# 打印信息，指示下载过程开始
echo "------------------------"
echo "开始下载原神APK文件..."
echo "APK文件将保存到: $APK_FILE"
echo "------------------------"

# 使用curl命令下载APK文件
curl -o "$APK_FILE" "$APK_URL" 2>&1 | tee /dev/null

# ---------------------------------------------------
# 检查APK文件是否下载成功
if [ ! -f "$APK_FILE" ]; then
    echo "下载失败：APK文件未找到！"
    exit 1
else
    echo "APK文件下载成功！"
fi
# ---------------------------------------------------

# ---------------------------------------------------
# 打印信息，指示安装过程开始
echo "------------------------"
echo "开始安装原神..."
echo "安装APK文件: $APK_FILE"
echo "------------------------"

# 使用pm命令安装APK文件
pm install "$APK_FILE" 2>&1 | tee /dev/null

# ---------------------------------------------------
# 检查安装是否成功
if [ $? -eq 0 ]; then
    echo "原神安装成功！"
else
    echo "原神安装失败！"
    exit 1
fi
# ---------------------------------------------------

# ---------------------------------------------------
# 打印结束信息
echo "------------------------"
echo "安装过程已完成！"
echo "------------------------"
